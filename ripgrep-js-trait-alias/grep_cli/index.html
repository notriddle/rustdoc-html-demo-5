<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This crate provides common routines used in command line applications, with a focus on routines useful for search oriented applications. As a utility library, there is no central type or function. However, a key focus of this crate is to improve failure modes and provide user friendly error messages when things go wrong."><title>grep_cli - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-deb46770fd761b69.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="grep_cli" data-themes="" data-resource-suffix="" data-rustdoc-version="1.75.0-dev" data-channel="nightly" data-search-js="search-8fbf244ebcf71464.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-9dd44ab47b99a0fb.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../grep_cli/index.html">grep_cli</a><span class="version">0.1.9</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">grep_cli</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/grep_cli/lib.rs.html#1-246">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This crate provides common routines used in command line applications, with a
focus on routines useful for search oriented applications. As a utility
library, there is no central type or function. However, a key focus of this
crate is to improve failure modes and provide user friendly error messages
when things go wrong.</p>
<p>To the best extent possible, everything in this crate works on Windows, macOS
and Linux.</p>
<h2 id="standard-io"><a href="#standard-io">Standard I/O</a></h2>
<p><a href="fn.is_readable_stdin.html" title="fn grep_cli::is_readable_stdin"><code>is_readable_stdin</code></a> determines whether stdin can be usefully read from. It
is useful when writing an application that changes behavior based on whether
the application was invoked with data on stdin. For example, <code>rg foo</code> might
recursively search the current working directory for occurrences of <code>foo</code>, but
<code>rg foo &lt; file</code> might only search the contents of <code>file</code>.</p>
<h2 id="coloring-and-buffering"><a href="#coloring-and-buffering">Coloring and buffering</a></h2>
<p>The <a href="fn.stdout.html" title="fn grep_cli::stdout"><code>stdout</code></a>, <a href="fn.stdout_buffered_block.html" title="fn grep_cli::stdout_buffered_block"><code>stdout_buffered_block</code></a> and <a href="fn.stdout_buffered_line.html" title="fn grep_cli::stdout_buffered_line"><code>stdout_buffered_line</code></a> routines
are alternative constructors for <a href="struct.StandardStream.html" title="struct grep_cli::StandardStream"><code>StandardStream</code></a>. A <code>StandardStream</code>
implements <code>termcolor::WriteColor</code>, which provides a way to emit colors to
terminals. Its key use is the encapsulation of buffering style. Namely,
<code>stdout</code> will return a line buffered <code>StandardStream</code> if and only if
stdout is connected to a tty, and will otherwise return a block buffered
<code>StandardStream</code>. Line buffering is important for use with a tty because it
typically decreases the latency at which the end user sees output. Block
buffering is used otherwise because it is faster, and redirecting stdout to a
file typically doesn’t benefit from the decreased latency that line buffering
provides.</p>
<p>The <code>stdout_buffered_block</code> and <code>stdout_buffered_line</code> can be used to
explicitly set the buffering strategy regardless of whether stdout is connected
to a tty or not.</p>
<h2 id="escaping"><a href="#escaping">Escaping</a></h2>
<p>The <a href="fn.escape.html" title="fn grep_cli::escape"><code>escape</code></a>, <a href="fn.escape_os.html" title="fn grep_cli::escape_os"><code>escape_os</code></a>, <a href="fn.unescape.html" title="fn grep_cli::unescape"><code>unescape</code></a> and
<a href="fn.unescape_os.html" title="fn grep_cli::unescape_os"><code>unescape_os</code></a> routines provide a user friendly way of dealing with UTF-8
encoded strings that can express arbitrary bytes. For example, you might want
to accept a string containing arbitrary bytes as a command line argument, but
most interactive shells make such strings difficult to type. Instead, we can
ask users to use escape sequences.</p>
<p>For example, <code>a\xFFz</code> is itself a valid UTF-8 string corresponding to the
following bytes:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code>[<span class="string">b&#39;a&#39;</span>, <span class="string">b&#39;\\&#39;</span>, <span class="string">b&#39;x&#39;</span>, <span class="string">b&#39;F&#39;</span>, <span class="string">b&#39;F&#39;</span>, <span class="string">b&#39;z&#39;</span>]</code></pre></div>
<p>However, we can
interpret <code>\xFF</code> as an escape sequence with the <code>unescape</code>/<code>unescape_os</code>
routines, which will yield</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code>[<span class="string">b&#39;a&#39;</span>, <span class="string">b&#39;\xFF&#39;</span>, <span class="string">b&#39;z&#39;</span>]</code></pre></div>
<p>instead. For example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>grep_cli::unescape;

<span class="comment">// Note the use of a raw string!
</span><span class="macro">assert_eq!</span>(<span class="macro">vec!</span>[<span class="string">b&#39;a&#39;</span>, <span class="string">b&#39;\xFF&#39;</span>, <span class="string">b&#39;z&#39;</span>], unescape(<span class="string">r&quot;a\xFFz&quot;</span>));</code></pre></div>
<p>The <code>escape</code>/<code>escape_os</code> routines provide the reverse transformation, which
makes it easy to show user friendly error messages involving arbitrary bytes.</p>
<h2 id="building-patterns"><a href="#building-patterns">Building patterns</a></h2>
<p>Typically, regular expression patterns must be valid UTF-8. However, command
line arguments aren’t guaranteed to be valid UTF-8. Unfortunately, the standard
library’s UTF-8 conversion functions from <code>OsStr</code>s do not provide good error
messages. However, the <a href="fn.pattern_from_bytes.html" title="fn grep_cli::pattern_from_bytes"><code>pattern_from_bytes</code></a> and <a href="fn.pattern_from_os.html" title="fn grep_cli::pattern_from_os"><code>pattern_from_os</code></a> do,
including reporting exactly where the first invalid UTF-8 byte is seen.</p>
<p>Additionally, it can be useful to read patterns from a file while reporting
good error messages that include line numbers. The <a href="fn.patterns_from_path.html" title="fn grep_cli::patterns_from_path"><code>patterns_from_path</code></a>,
<a href="fn.patterns_from_reader.html" title="fn grep_cli::patterns_from_reader"><code>patterns_from_reader</code></a> and <a href="fn.patterns_from_stdin.html" title="fn grep_cli::patterns_from_stdin"><code>patterns_from_stdin</code></a> routines do just that. If
any pattern is found that is invalid UTF-8, then the error includes the file
path (if available) along with the line number and the byte offset at which the
first invalid UTF-8 byte was observed.</p>
<h2 id="read-process-output"><a href="#read-process-output">Read process output</a></h2>
<p>Sometimes a command line application needs to execute other processes and
read its stdout in a streaming fashion. The <a href="struct.CommandReader.html" title="struct grep_cli::CommandReader"><code>CommandReader</code></a> provides this
functionality with an explicit goal of improving failure modes. In particular,
if the process exits with an error code, then stderr is read and converted into
a normal Rust error to show to end users. This makes the underlying failure
modes explicit and gives more information to end users for debugging the
problem.</p>
<p>As a special case, <a href="struct.DecompressionReader.html" title="struct grep_cli::DecompressionReader"><code>DecompressionReader</code></a> provides a way to decompress
arbitrary files by matching their file extensions up with corresponding
decompression programs (such as <code>gzip</code> and <code>xz</code>). This is useful as a means of
performing simplistic decompression in a portable manner without binding to
specific compression libraries. This does come with some overhead though, so
if you need to decompress lots of small files, this may not be an appropriate
convenience to use.</p>
<p>Each reader has a corresponding builder for additional configuration, such as
whether to read stderr asynchronously in order to avoid deadlock (which is
enabled by default).</p>
<h2 id="miscellaneous-parsing"><a href="#miscellaneous-parsing">Miscellaneous parsing</a></h2>
<p>The <a href="fn.parse_human_readable_size.html" title="fn grep_cli::parse_human_readable_size"><code>parse_human_readable_size</code></a> routine parses strings like <code>2M</code> and converts
them to the corresponding number of bytes (<code>2 * 1&lt;&lt;20</code> in this case). If an
invalid size is found, then a good error message is crafted that typically
tells the user how to fix the problem.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.CommandError.html" title="struct grep_cli::CommandError">CommandError</a></div><div class="desc docblock-short">An error that can occur while running a command and reading its output.</div></li><li><div class="item-name"><a class="struct" href="struct.CommandReader.html" title="struct grep_cli::CommandReader">CommandReader</a></div><div class="desc docblock-short">A streaming reader for a command’s output.</div></li><li><div class="item-name"><a class="struct" href="struct.CommandReaderBuilder.html" title="struct grep_cli::CommandReaderBuilder">CommandReaderBuilder</a></div><div class="desc docblock-short">Configures and builds a streaming reader for process output.</div></li><li><div class="item-name"><a class="struct" href="struct.DecompressionMatcher.html" title="struct grep_cli::DecompressionMatcher">DecompressionMatcher</a></div><div class="desc docblock-short">A matcher for determining how to decompress files.</div></li><li><div class="item-name"><a class="struct" href="struct.DecompressionMatcherBuilder.html" title="struct grep_cli::DecompressionMatcherBuilder">DecompressionMatcherBuilder</a></div><div class="desc docblock-short">A builder for a matcher that determines which files get decompressed.</div></li><li><div class="item-name"><a class="struct" href="struct.DecompressionReader.html" title="struct grep_cli::DecompressionReader">DecompressionReader</a></div><div class="desc docblock-short">A streaming reader for decompressing the contents of a file.</div></li><li><div class="item-name"><a class="struct" href="struct.DecompressionReaderBuilder.html" title="struct grep_cli::DecompressionReaderBuilder">DecompressionReaderBuilder</a></div><div class="desc docblock-short">Configures and builds a streaming reader for decompressing data.</div></li><li><div class="item-name"><a class="struct" href="struct.InvalidPatternError.html" title="struct grep_cli::InvalidPatternError">InvalidPatternError</a></div><div class="desc docblock-short">An error that occurs when a pattern could not be converted to valid UTF-8.</div></li><li><div class="item-name"><a class="struct" href="struct.ParseSizeError.html" title="struct grep_cli::ParseSizeError">ParseSizeError</a></div><div class="desc docblock-short">An error that occurs when parsing a human readable size description.</div></li><li><div class="item-name"><a class="struct" href="struct.StandardStream.html" title="struct grep_cli::StandardStream">StandardStream</a></div><div class="desc docblock-short">A writer that supports coloring with either line or block buffering.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.escape.html" title="fn grep_cli::escape">escape</a></div><div class="desc docblock-short">Escapes arbitrary bytes into a human readable string.</div></li><li><div class="item-name"><a class="fn" href="fn.escape_os.html" title="fn grep_cli::escape_os">escape_os</a></div><div class="desc docblock-short">Escapes an OS string into a human readable string.</div></li><li><div class="item-name"><a class="fn" href="fn.hostname.html" title="fn grep_cli::hostname">hostname</a></div><div class="desc docblock-short">Returns the hostname of the current system.</div></li><li><div class="item-name"><a class="fn" href="fn.is_readable_stdin.html" title="fn grep_cli::is_readable_stdin">is_readable_stdin</a></div><div class="desc docblock-short">Returns true if and only if stdin is believed to be readable.</div></li><li><div class="item-name"><a class="fn" href="fn.is_tty_stderr.html" title="fn grep_cli::is_tty_stderr">is_tty_stderr</a><span class="stab deprecated" title="">Deprecated</span></div><div class="desc docblock-short">Returns true if and only if stderr is believed to be connected to a tty
or a console.</div></li><li><div class="item-name"><a class="fn" href="fn.is_tty_stdin.html" title="fn grep_cli::is_tty_stdin">is_tty_stdin</a><span class="stab deprecated" title="">Deprecated</span></div><div class="desc docblock-short">Returns true if and only if stdin is believed to be connected to a tty
or a console.</div></li><li><div class="item-name"><a class="fn" href="fn.is_tty_stdout.html" title="fn grep_cli::is_tty_stdout">is_tty_stdout</a><span class="stab deprecated" title="">Deprecated</span></div><div class="desc docblock-short">Returns true if and only if stdout is believed to be connected to a tty
or a console.</div></li><li><div class="item-name"><a class="fn" href="fn.parse_human_readable_size.html" title="fn grep_cli::parse_human_readable_size">parse_human_readable_size</a></div><div class="desc docblock-short">Parse a human readable size like <code>2M</code> into a corresponding number of bytes.</div></li><li><div class="item-name"><a class="fn" href="fn.pattern_from_bytes.html" title="fn grep_cli::pattern_from_bytes">pattern_from_bytes</a></div><div class="desc docblock-short">Convert arbitrary bytes into a regular expression pattern.</div></li><li><div class="item-name"><a class="fn" href="fn.pattern_from_os.html" title="fn grep_cli::pattern_from_os">pattern_from_os</a></div><div class="desc docblock-short">Convert an OS string into a regular expression pattern.</div></li><li><div class="item-name"><a class="fn" href="fn.patterns_from_path.html" title="fn grep_cli::patterns_from_path">patterns_from_path</a></div><div class="desc docblock-short">Read patterns from a file path, one per line.</div></li><li><div class="item-name"><a class="fn" href="fn.patterns_from_reader.html" title="fn grep_cli::patterns_from_reader">patterns_from_reader</a></div><div class="desc docblock-short">Read patterns from any reader, one per line.</div></li><li><div class="item-name"><a class="fn" href="fn.patterns_from_stdin.html" title="fn grep_cli::patterns_from_stdin">patterns_from_stdin</a></div><div class="desc docblock-short">Read patterns from stdin, one per line.</div></li><li><div class="item-name"><a class="fn" href="fn.resolve_binary.html" title="fn grep_cli::resolve_binary">resolve_binary</a></div><div class="desc docblock-short">Resolves a path to a program to a path by searching for the program in
<code>PATH</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.stdout.html" title="fn grep_cli::stdout">stdout</a></div><div class="desc docblock-short">Returns a possibly buffered writer to stdout for the given color choice.</div></li><li><div class="item-name"><a class="fn" href="fn.stdout_buffered_block.html" title="fn grep_cli::stdout_buffered_block">stdout_buffered_block</a></div><div class="desc docblock-short">Returns a block buffered writer to stdout for the given color choice.</div></li><li><div class="item-name"><a class="fn" href="fn.stdout_buffered_line.html" title="fn grep_cli::stdout_buffered_line">stdout_buffered_line</a></div><div class="desc docblock-short">Returns a line buffered writer to stdout for the given color choice.</div></li><li><div class="item-name"><a class="fn" href="fn.unescape.html" title="fn grep_cli::unescape">unescape</a></div><div class="desc docblock-short">Unescapes a string.</div></li><li><div class="item-name"><a class="fn" href="fn.unescape_os.html" title="fn grep_cli::unescape_os">unescape_os</a></div><div class="desc docblock-short">Unescapes an OS string.</div></li></ul></section></div></main></body></html>